package gtne.common.metatileentities.multi;

import gregtech.api.GTValues;
import gregtech.api.capability.IOpticalComputationHatch;
import gregtech.api.capability.IOpticalComputationProvider;
import gregtech.api.capability.IOpticalComputationReceiver;
import gregtech.api.capability.impl.ComputationRecipeLogic;
import gregtech.api.capability.impl.EnergyContainerList;
import gregtech.api.metatileentity.MetaTileEntity;
import gregtech.api.metatileentity.interfaces.IGregTechTileEntity;
import gregtech.api.metatileentity.multiblock.IMultiblockPart;
import gregtech.api.metatileentity.multiblock.MultiblockAbility;
import gregtech.api.metatileentity.multiblock.RecipeMapMultiblockController;
import gregtech.api.pattern.BlockPattern;
import gregtech.api.pattern.FactoryBlockPattern;
import gregtech.api.pattern.PatternMatchContext;
import gregtech.api.pattern.TraceabilityPredicate;
import gregtech.api.recipes.Recipe;
import gregtech.api.recipes.RecipeMaps;
import gregtech.api.recipes.recipeproperties.FusionEUToStartProperty;
import gregtech.client.renderer.ICubeRenderer;
import gregtech.common.metatileentities.MetaTileEntities;
import gregtech.common.metatileentities.multi.multiblockpart.MetaTileEntityMultiFluidHatch;
import gtne.api.recipes.GTNERecipeMaps;
import gtne.client.GTNETextures;
import gtne.common.Block.BlockGTNEWireCoil;
import gtne.common.Block.DHSCTCasing;
import gtne.common.Block.GTNEMetaBlock;
import net.minecraft.util.ResourceLocation;
import org.jetbrains.annotations.NotNull;

import javax.annotation.Nonnull;

import java.util.Arrays;
import java.util.List;

import static gregtech.api.GTValues.*;

public class MetaTileEntityHighDimensionalStructureConstructionTesseract extends RecipeMapMultiblockController implements IOpticalComputationReceiver {

    private IOpticalComputationProvider computationProvider;

    public MetaTileEntityHighDimensionalStructureConstructionTesseract(ResourceLocation metaTileEntityId) {
        super(metaTileEntityId, GTNERecipeMaps.HIGH_DIMENTIONAL_STRUCTURE_CONSTRUCTION_TESSERACT);
        this.recipeMapWorkable = new HDSCTRecipeLogic(this);
    }


    @Override
    public MetaTileEntity createMetaTileEntity(IGregTechTileEntity tileEntity) {
        return new MetaTileEntityHighDimensionalStructureConstructionTesseract(metaTileEntityId);
    }

    @Override
    protected void formStructure(PatternMatchContext context) {
        super.formStructure(context);
        List<IOpticalComputationHatch> providers = getAbilities(MultiblockAbility.COMPUTATION_DATA_RECEPTION);
        if (providers != null && providers.size() >= 1) {
            computationProvider = providers.get(0);
        }
        if (computationProvider == null) {
            invalidateStructure();
        }
    }

    @Override
    public ComputationRecipeLogic getRecipeMapWorkable() {
        return (ComputationRecipeLogic) recipeMapWorkable;
    }

    @Override
    public IOpticalComputationProvider getComputationProvider() {
        return computationProvider;
    }

    @Nonnull
    @Override
    protected BlockPattern createStructurePattern() {
        return FactoryBlockPattern.start()
                      //Layer0 Bottom : 44                      //Layer1 Center : 85                     //Layer2 Center : 126                    //Layer3 Center : 167                    //Layer4 Center : 208                    //Layer5 Center : 249                    //Layer6 Center : 290                    //Layer7 Center : 331                    //Layer8 Center : 372                    //Layer9 Center : 413                    //Layer10 Center : 454                   //Layer11 Center : 495                   //Layer12 Center : 536                   //Layer13 Center : 577                   //Layer14 Center : 618                   //Layer15 Center : 659                   //Layer16 Center : 700                   //Layer17 Center : 741                   //Layer18 Center : 782 Center Layer      //Layer19 Center : 823 Link - Layer17    //Layer20 Center : 864 Link - Layer16    //Layer21 Center : 905 Link - Layer15    //Layer22 Center : 946 Link - Layer14    //Layer23 Center : 987 Link - Layer13    //Layer24 Center : 1028 Link - Layer12   //Layer25 Center : 1069 Link - Layer11   //Layer26 Center : 1110 Link - Layer10   //Layer27 Center : 1151 Link - Layer9    //Layer28 Center : 1192 Link - Layer8    //Layer29 Center : 1233 Link - Layer7    //Layer30 Center : 1274 Link - Layer6    //Layer31 Center : 1315 Link - Layer5    //Layer32 Center : 1356 Link - Layer4    //Layer33 Center : 1397 Link - Layer3    //Layer34 Center : 1438 Link - Layer2    //Layer35 Center : 1479 Link - Layer1    //Layer36 Bottom
                .aisle(" BX  XXX   XXXMMM   MMMXXX   XXX  XB ", "B  XX   BBB      BBB      BBB   XX  B", "X X     LLL      XCX      LLL     X X", " X      LLL      XMX      LLL      X ", " X     LLL       XMX       LLL     X ", "X      LLL       XMX       LLL      X", "X     LLL        BCB        LLL     X", "X   LLLL         XMX         LLLL   X", " BLLLLL          XMX          LLLLLB ", " BLLLL           XMX           LLLLB ", " BLL          XXXBCBXXX          LLB ", "X           CC   XMX   CC           X", "X          C     XMX     C          X", "X          C     XMX     C          X", "M         X      BCB      X         M", "M         X     XMMMX     X         M", "M         X    XXBXBXX    X         M", " BXXXXBXXXBXXXBMBSXSBMBXXXBXXXBXXXXB ", " BCMMMCMMMCMMMCMXXBXXMCMMMCMMMCMMMCB ", " BXXXXBXXXBXXXBMBSXSBMBXXXBXXXBXXXXB ", "M         X    XXBXBXX    X         M", "M         X     XMMMX     X         M", "M         X      BCB      X         M", "X          C     XMX     C          X", "X          C     XMX     C          X", "X           CC   XMX   CC           X", " BLL          XXXBCBXXX          LLB ", " BLLLL           XMX           LLLLB ", " BLLLLL          XMX          LLLLLB ", "X   LLLL         XMX         LLLL   X", "X     LLL        BCB        LLL     X", "X      LLL       XMX       LLL      X", " X     LLL       XMX       LLL     X ", " X      LLL      XMX      LLL      X ", "X X     LLL      XCX      LLL     X X", "B  XX   BBB      BBB      BBB   XX  B", " BX  XXX   XXXMMM   MMMXXX   XXX  XB ")//1
                .aisle("B  XX   BBB      BBB      BBB   XX  B", "                                     ", "  B                               B  ", "X                                   X", "X                                   X", "                                     ", "                                     ", "                                     ", "B                                   B", "B                                   B", "B                                   B", "                                     ", "                                     ", "                                     ", "                                     ", "                                     ", "                                     ", "B                                   B", "B                 X                 B", "B                                   B", "                                     ", "                                     ", "                                     ", "                                     ", "                                     ", "                                     ", "B                                   B", "B                                   B", "B                                   B", "                                     ", "                                     ", "                                     ", "X                                   X", "X                                   X", "  B                               B  ", "                                     ", "B  XX   BBB      BBB      BBB   XX  B")//2
                .aisle("X X     LLL      XCX      LLL     X X", "  B                               B  ", "XBCM                             MCBX", "  MX                             XM  ", "                                     ", "                                     ", "                                     ", "                                     ", "L                                   L", "L                                   L", "L                                   L", "                                     ", "                                     ", "                                     ", "                                     ", "                D X D                ", "                S X S                ", "X                 X                 X", "C              XXXXXXX              C", "X                 X                 X", "                S X S                ", "                D X D                ", "                                     ", "                                     ", "                                     ", "                                     ", "L                                   L", "L                                   L", "L                                   L", "                                     ", "                                     ", "                                     ", "                                     ", "  MX                             XM  ", "XBCM                             MCBX", "  B                               B  ", "X X     LLL      XCX      LLL     X X")//3
                .aisle(" X      LLL      XMX      LLL      X ", "X                                   X", "  MX                             XM  ", "  XBM                           MBX  ", "   MX                           XM   ", "                                     ", "                                     ", "                                     ", "L                                   L", "L                                   L", "L                                   L", "                                     ", "                D X D                ", "               XBXCXBX               ", "                D X D                ", "                                     ", "                                     ", "X                                   X", "M           XXX   X   XXX           M", "X                                   X", "                                     ", "                                     ", "                D X D                ", "               XBXCXBX               ", "                D X D                ", "                                     ", "L                                   L", "L                                   L", "L                                   L", "                                     ", "                                     ", "                                     ", "   MX                           XM   ", "  XBM                           MBX  ", "  MX                             XM  ", "X                                   X", " X      LLL      XMX      LLL      X ")//4
                .aisle(" X     LLL       XMX       LLL     X ", "X                                   X", "                                     ", "   MX                           XM   ", "   XBM                         MBX   ", "    MX                         XM    ", "                                     ", "L                                   L", "L                                   L", "L                                   L", "                S X S                ", "                D X D                ", "                                     ", "                                     ", "                                     ", "                                     ", "                                     ", "X                                   X", "M         XX      X      XX         M", "X                                   X", "                                     ", "                                     ", "                                     ", "                                     ", "                                     ", "                D X D                ", "                S X S                ", "L                                   L", "L                                   L", "L                                   L", "                                     ", "    MX                         XM    ", "   XBM                         MBX   ", "   MX                           XM   ", "                                     ", "X                                   X", " X     LLL       XMX       LLL     X ")//5
                .aisle("X      LLL       XMX       LLL      X", "                                     ", "                                     ", "                                     ", "    MX                         XM    ", "    XBM                       MBX    ", "     MX                       XM     ", "L                                   L", "L                                   L", "L                 X                 L", "                                     ", "                                     ", "                                     ", "                                     ", "                                     ", "         S                 S         ", "         D                 D         ", "X        D        X        D        X", "M        C       XBX       C        M", "X        D        X        D        X", "         D                 D         ", "         S                 S         ", "                                     ", "                                     ", "                                     ", "                                     ", "                                     ", "L                 X                 L", "L                                   L", "L                                   L", "     MX                       XM     ", "    XBM                       MBX    ", "    MX                         XM    ", "                                     ", "                                     ", "                                     ", "X      LLL       XMX       LLL      X")//6
                .aisle("X     LLL        BCB        LLL     X", "                                     ", "                                     ", "                                     ", "                                     ", "     MX                       XM     ", "L    XBM                     MBX    L", "L     MX          B          XM     L", "L                 B                 L", "                                     ", "                                     ", "                                     ", "                                     ", "                                     ", "                                     ", "                                     ", "                                     ", "B                 X                 B", "C      BB        XBX        BB      C", "B                 X                 B", "                                     ", "                                     ", "                                     ", "                                     ", "                                     ", "                                     ", "                                     ", "                                     ", "L                 B                 L", "L     MX          B          XM     L", "L    XBM                     MBX    L", "     MX                       XM     ", "                                     ", "                                     ", "                                     ", "                                     ", "X     LLL        BCB        LLL     X")//7
                .aisle("X   LLLL         XMX         LLLL   X", "                                     ", "                                     ", "                                     ", "L                                   L", "L                                   L", "L     MX          B          XM     L", "L     XBM                   MBX     L", "       MX  X   X     X   X  XM       ", "          BX   X     X   XB          ", "         B X   X     X   X B         ", "        XXX               XXX        ", "                                     ", "                                     ", "                                     ", "        XXX               XXX        ", "                                     ", "X                 X                 X", "M     B          XBX          B     M", "X                 X                 X", "                                     ", "        XXX               XXX        ", "                                     ", "                                     ", "                                     ", "        XXX               XXX        ", "         B X   X     X   X B         ", "          BX   X     X   XB          ", "       MX  X   X     X   X  XM       ", "L     XBM                   MBX     L", "L     MX          B          XM     L", "L                                   L", "L                                   L", "                                     ", "                                     ", "                                     ", "X   LLLL         XMX         LLLL   X")//8
                .aisle(" BLLLLL          XMX          LLLLLB ", "B                                   B", "L                                   L", "L                                   L", "L                                   L", "L                                   L", "L                 B                 L", "       MX  X   X     X   X  XM       ", "       XBM MLLLMB   BMLLLM MBX       ", "        MX MLLLMXX XXMLLLM XM        ", "           MLLLMB   BMLLLM           ", "       XMMMB   X     X   BMMMX       ", "        LLL               LLL        ", "        LLL               LLL        ", "        LLL               LLL        ", "       XMMMX             XMMMX       ", "        BXB       X       BXB        ", "X        X                 X        X", "M     B         XXBXX         B     M", "X        X                 X        X", "        BXB       X       BXB        ", "       XMMMX             XMMMX       ", "        LLL               LLL        ", "        LLL               LLL        ", "        LLL               LLL        ", "       XMMMB   X     X   BMMMX       ", "           MLLLMB   BMLLLM           ", "        MX MLLLMXX XXMLLLM XM        ", "       XBM MLLLMB   BMLLLM MBX       ", "       MX  X   X     X   X  XM       ", "L                 B                 L", "L                                   L", "L                                   L", "L                                   L", "L                                   L", "B                                   B", " BLLLLL          XMX          LLLLLB ")//9
                .aisle(" BLLLL           XMX           LLLLB ", "B                                   B", "L                                   L", "L                                   L", "L                                   L", "L                 X                 L", "                                     ", "          BX   X     X   XB          ", "        MX MLLLMXX XXMLLLM XM        ", "        XCBMCCCMMMBMMMCCCMBCX        ", "       B B MLLLMXX XXMLLLM B B       ", "       XMMMB   X     X   BMMMX       ", "        LCL               LCL        ", "        LCL               LCL        ", "        LCL               LCL        ", "     S XMMMX             XMMMX S     ", "     D  XMX       X       XMX  D     ", "X    D  XMX               XMX  D    X", "M    C   B      XXBXX      B   C    M", "X    D  XMX               XMX  D    X", "     D  XMX       X       XMX  D     ", "     S XMMMX             XMMMX S     ", "        LCL               LCL        ", "        LCL               LCL        ", "        LCL               LCL        ", "       XMMMB   X     X   BMMMX       ", "       B B MLLLMXX XXMLLLM B B       ", "        XCBMCCCMMMBMMMCCCMBCX        ", "        MX MLLLMXX XXMLLLM XM        ", "          BX   X     X   XB          ", "                                     ", "L                 X                 L", "L                                   L", "L                                   L", "L                                   L", "B                                   B", " BLLLL           XMX           LLLLB ")//10
                .aisle(" BLL          XXXBCBXXX          LLB ", "B                                   B", "L                                   L", "L                                   L", "                S X S                ", "                                     ", "                                     ", "         B X   X     X   X B         ", "           MLLLMB   BMLLLM           ", "       B B MLLLMXX XXMLLLM B B       ", "           MLLLMB   BMLLLM           ", "       XMMMB   X     X   BMMMX       ", "        LLL               LLL        ", "        LLL               LLL        ", "X       LLL               LLL       X", "X      XMMMX      X      XMMMX      X", "X       BXB               BXB       X", "B        X                 X        B", "C   X          X XBX X          X   C", "B        X                 X        B", "X       BXB               BXB       X", "X      XMMMX      X      XMMMX      X", "X       LLL               LLL       X", "        LLL               LLL        ", "        LLL               LLL        ", "       XMMMB   X     X   BMMMX       ", "           MLLLMB   BMLLLM           ", "       B B MLLLMXX XXMLLLM B B       ", "           MLLLMB   BMLLLM           ", "         B X   X     X   X B         ", "                                     ", "                                     ", "                S X S                ", "L                                   L", "L                                   L", "B                                   B", " BLL          XXXBCBXXX          LLB ")//11
                .aisle("X           CC   XMX   CC           X", "                                     ", "                                     ", "                                     ", "                D X D                ", "                                     ", "                                     ", "        XXX               XXX        ", "       XMMMB   X     X   BMMMX       ", "       XMMMB   X     X   BMMMX       ", "       XMMMB    X   X    BMMMX       ", "        BBB               BBB        ", "C                                   C", "C                                   C", "                  X                  ", "        XXX               XXX        ", "                                     ", "X                                   X", "M   X         X  XBX  X         X   M", "X                                   X", "                                     ", "        XXX               XXX        ", "                  X                  ", "C                                   C", "C                                   C", "        BBB               BBB        ", "       XMMMB    X   X    BMMMX       ", "       XMMMB   X     X   BMMMX       ", "       XMMMB   X     X   BMMMX       ", "        XXX               XXX        ", "                                     ", "                                     ", "                D X D                ", "                                     ", "                                     ", "                                     ", "X           CC   XMX   CC           X")//12
                .aisle("X          C     XMX     C          X", "                                     ", "                                     ", "                D X D                ", "                                     ", "                                     ", "                                     ", "                                     ", "        LLL               LLL        ", "        LCL               LCL        ", "        LLL               LLL        ", "C                                   C", "                                     ", "                  X                  ", "                                     ", "                                     ", "                                     ", "X                                   X", "M  X         X   XBX   X         X  M", "X                                   X", "                                     ", "                                     ", "                                     ", "                  X                  ", "                                     ", "C                                   C", "        LLL               LLL        ", "        LCL               LCL        ", "        LLL               LLL        ", "                                     ", "                                     ", "                                     ", "                                     ", "                D X D                ", "                                     ", "                                     ", "X          C     XMX     C          X")//13
                .aisle("X          C     XMX     C          X", "                                     ", "                                     ", "               XBXCXBX               ", "                                     ", "                                     ", "                                     ", "                                     ", "        LLL               LLL        ", "        LCL               LCL        ", "        LLL               LLL        ", "C                                   C", "                  X                  ", "                                     ", "                                     ", "                                     ", "                                     ", "X                                   X", "M  X        X    XFX    X        X  M", "X                                   X", "                                     ", "                                     ", "                                     ", "                                     ", "                  X                  ", "C                                   C", "        LLL               LLL        ", "        LCL               LCL        ", "        LLL               LLL        ", "                                     ", "                                     ", "                                     ", "                                     ", "               XBXCXBX               ", "                                     ", "                                     ", "X          C     XMX     C          X")//14
                .aisle("M         X      BCB      X         M", "                                     ", "                                     ", "                D X D                ", "                                     ", "                                     ", "                                     ", "                                     ", "        LLL               LLL        ", "        LCL               LCL        ", "X       LLL               LLL       X", "                  X                  ", "                                     ", "                                     ", "                                     ", "                                     ", "                                     ", "B                                   B", "C  X       X     XFX     X       X  C", "B                                   B", "                                     ", "                                     ", "                                     ", "                                     ", "                                     ", "                  X                  ", "X       LLL               LLL       X", "        LCL               LCL        ", "        LLL               LLL        ", "                                     ", "                                     ", "                                     ", "                                     ", "                D X D                ", "                                     ", "                                     ", "M         X      BCB      X         M")//15
                .aisle("M         X     XMMMX     X         M", "                                     ", "                D X D                ", "             X         X             ", "                                     ", "                                     ", "                                     ", "        XXX               XXX        ", "       XMMMX             XMMMX       ", "       XMMMX             XMMMX       ", "X      XMMMX      X      XMMMX      X", "        XXX               XXX        ", "                                     ", "   X                             X   ", "                                     ", "                                     ", "X                                   X", "M                                   M", "M X       X      XUX      X       X M", "M                                   M", "X                                   X", "                                     ", "                                     ", "   X                             X   ", "                                     ", "        XXX               XXX        ", "X      XMMMX      X      XMMMX      X", "       XMMMX             XMMMX       ", "       XMMMX             XMMMX       ", "        XXX               XXX        ", "                                     ", "                                     ", "                                     ", "             X         X             ", "                D X D                ", "                                     ", "M         X     XMMMX     X         M")//16
                .aisle("M         X    XXBXBXX    X         M", "                                     ", "               DS X SD               ", "            DBD       DBD            ", "          SD             DS          ", "                                     ", "                                     ", "                                     ", "        BXB       X       BXB        ", "        XMX       X       XMX        ", "X   S   BXB               BXB   S   X", "    D                           D    ", "   C                             C   ", "   B                             B   ", "   D                             D   ", "X D                               D X", "X S                               S X", "B                                   B", "X X     XX      XBXBX      XX     X X", "B                                   B", "X S                               S X", "X D                               D X", "   D                             D   ", "   B                             B   ", "   C                             C   ", "    D                           D    ", "X   S   BXB               BXB   S   X", "        XMX       X       XMX        ", "        BXB       X       BXB        ", "                                     ", "                                     ", "                                     ", "          SD             DS          ", "            DBD       DBD            ", "               DS X SD               ", "                                     ", "M         X    XXBXBXX    X         M")//17
                .aisle(" BXXXXBXXXBXXXBMBSXSBMBXXXBXXXBXXXXB ", "B                                   B", "X                 X                 X", "X            X         X            X", "X                                   X", "X                 X                 X", "B                 X                 B", "X                 X                 X", "X        X                 X        X", "X       XMX               XMX       X", "B        X                 X        B", "X                                   X", "X                                   X", "X  X                             X  X", "B                                   B", "M                                   M", "B                                   B", "S                                   S", "X X  XXXXXXXXXXXBEIEBXXXXXXXXXXX  X X", "S                                   S", "B                                   B", "M                                   M", "B                                   B", "X  X                             X  X", "X                                   X", "X                                   X", "B        X                 X        B", "X       XMX               XMX       X", "B        X                 X        B", "X                 X                 X", "B                 X                 B", "X                 X                 X", "X                                   X", "X            X         X            X", "X                 X                 X", "B                                   B", " BXXXXBXXXBXXXBMBSXSBMBXXXBXXXBXXXXB ")//18
                .aisle(" BCMMMCMMMCMMMCMXXBXXMCMMMCMMMCMMMCB ", "B                 B                 B", "C              XXXSXXX              C", "M           XCX   X   XCX           M", "M         XX      X      XX         M", "M        X       X X       X        M", "C      BB        X X        BB      C", "M     B          X X          B     M", "M     B         X   X         B     M", "M    X   B      X   X      B   X    M", "C   X          X     X          X   C", "M   X         X       X         X   M", "M  X         X         X         X  M", "M  C        X           X        C  M", "C  X       X             X       X  C", "M X       X               X       X M", "X X     XX                 XX     X X", "X X  XXX                     XXX  X X", "BXXXXBBBBBBBBFFUXYMYXUFFBBBBBBBBXXXXB", "X X  XXX          A          XXX  X X", "X X     XX                 XX     X X", "M X       X               X       X M", "C  X       X             X       X  C", "M  C        X           X        C  M", "M  X         X         X         X  M", "M   X         X       X         X   M", "C   X          X     X          X   C", "M    X   B      X   X      B   X    M", "M     B         X   X         B     M", "M     B          X X          B     M", "M      BB       X   X       BB      M", "M        X       X X       X        M", "M         XX      X      XX         M", "M           XCX   X   XCX           M", "C              XXXSXXX              C", "B                 B                 B", " BCMMMCMMMCMMMCMXXBXXMCMMMCMMMCMMMCB ")//19
                .aisle(" BXXXXBXXXBXXXBMBSXSBMBXXXBXXXBXXXXB ", "B                                   B", "X                 X                 X", "X            X         X            X", "X                                   X", "X                 X                 X", "B                 X                 B", "X                 X                 X", "X        X                 X        X", "X       XMX               XMX       X", "B        X                 X        B", "X                                   X", "X                                   X", "X  X                             X  X", "B                                   B", "M                                   M", "B                                   B", "S                                   S", "X X  XXXXXXXXXXXBEOEBXXXXXXXXXXX  X X", "S                                   S", "B                                   B", "M                                   M", "B                                   B", "X  X                             X  X", "X                                   X", "X                                   X", "B        X                 X        B", "X       XMX               XMX       X", "B        X                 X        B", "X                 X                 X", "B                 X                 B", "X                 X                 X", "X                                   X", "X            X         X            X", "X                 X                 X", "B                                   B", " BXXXXBXXXBXXXBMBSXSBMBXXXBXXXBXXXXB ")//20
                .aisle("M         X    XXBXBXX    X         M", "                                     ", "               DS X SD               ", "            DBD       DBD            ", "          SD             DS          ", "                                     ", "                                     ", "                                     ", "        BXB       X       BXB        ", "        XMX       X       XMX        ", "X   S   BXB               BXB   S   X", "    D                           D    ", "   C                             C   ", "   B                             B   ", "   D                             D   ", "X D                               D X", "X S                               S X", "B                                   B", "X X     XX      XBXBX      XX     X X", "B                                   B", "X S                               S X", "X D                               D X", "   D                             D   ", "   B                             B   ", "   C                             C   ", "    D                           D    ", "X   S   BXB               BXB   S   X", "        XMX       X       XMX        ", "        BXB       X       BXB        ", "                                     ", "                                     ", "                                     ", "          SD             DS          ", "            DBD       DBD            ", "               DS X SD               ", "                                     ", "M         X    XXBXBXX    X         M")//21
                .aisle("M         X     XMMMX     X         M", "                                     ", "                D X D                ", "             X         X             ", "                                     ", "                                     ", "                                     ", "        XXX               XXX        ", "       XMMMX             XMMMX       ", "       XMMMX             XMMMX       ", "X      XMMMX      X      XMMMX      X", "        XXX               XXX        ", "                                     ", "   X                             X   ", "                                     ", "                                     ", "X                                   X", "M                                   M", "M X       X      XUX      X       X M", "M                                   M", "X                                   X", "                                     ", "                                     ", "   X                             X   ", "                                     ", "        XXX               XXX        ", "X      XMMMX      X      XMMMX      X", "       XMMMX             XMMMX       ", "       XMMMX             XMMMX       ", "        XXX               XXX        ", "                                     ", "                                     ", "                                     ", "             X         X             ", "                D X D                ", "                                     ", "M         X     XMMMX     X         M")//22
                .aisle("M         X      BCB      X         M", "                                     ", "                                     ", "                D X D                ", "                                     ", "                                     ", "                                     ", "                                     ", "        LLL               LLL        ", "        LCL               LCL        ", "X       LLL               LLL       X", "                  X                  ", "                                     ", "                                     ", "                                     ", "                                     ", "                                     ", "B                                   B", "C  X       X     XFX     X       X  C", "B                                   B", "                                     ", "                                     ", "                                     ", "                                     ", "                                     ", "                  X                  ", "X       LLL               LLL       X", "        LCL               LCL        ", "        LLL               LLL        ", "                                     ", "                                     ", "                                     ", "                                     ", "                D X D                ", "                                     ", "                                     ", "M         X      BCB      X         M")//23
                .aisle("X          C     XMX     C          X", "                                     ", "                                     ", "               XBXCXBX               ", "                                     ", "                                     ", "                                     ", "                                     ", "        LLL               LLL        ", "        LCL               LCL        ", "        LLL               LLL        ", "C                                   C", "                  X                  ", "                                     ", "                                     ", "                                     ", "                                     ", "X                                   X", "M  X        X    XFX    X        X  M", "X                                   X", "                                     ", "                                     ", "                                     ", "                                     ", "                  X                  ", "C                                   C", "        LLL               LLL        ", "        LCL               LCL        ", "        LLL               LLL        ", "                                     ", "                                     ", "                                     ", "                                     ", "               XBXCXBX               ", "                                     ", "                                     ", "X          C     XMX     C          X")//24
                .aisle("X          C     XMX     C          X", "                                     ", "                                     ", "                D X D                ", "                                     ", "                                     ", "                                     ", "                                     ", "        LLL               LLL        ", "        LCL               LCL        ", "        LLL               LLL        ", "C                                   C", "                                     ", "                  X                  ", "                                     ", "                                     ", "                                     ", "X                                   X", "M  X         X   XBX   X         X  M", "X                                   X", "                                     ", "                                     ", "                                     ", "                  X                  ", "                                     ", "C                                   C", "        LLL               LLL        ", "        LCL               LCL        ", "        LLL               LLL        ", "                                     ", "                                     ", "                                     ", "                                     ", "                D X D                ", "                                     ", "                                     ", "X          C     XMX     C          X")//25
                .aisle("X           CC   XMX   CC           X", "                                     ", "                                     ", "                                     ", "                D X D                ", "                                     ", "                                     ", "        XXX               XXX        ", "       XMMMB   X     X   BMMMX       ", "       XMMMB   X     X   BMMMX       ", "       XMMMB    X   X    BMMMX       ", "        BBB               BBB        ", "C                                   C", "C                                   C", "                  X                  ", "        XXX               XXX        ", "                                     ", "X                                   X", "M   X         X  XBX  X         X   M", "X                                   X", "                                     ", "        XXX               XXX        ", "                  X                  ", "C                                   C", "C                                   C", "        BBB               BBB        ", "       XMMMB    X   X    BMMMX       ", "       XMMMB   X     X   BMMMX       ", "       XMMMB   X     X   BMMMX       ", "        XXX               XXX        ", "                                     ", "                                     ", "                D X D                ", "                                     ", "                                     ", "                                     ", "X           CC   XMX   CC           X")//26
                .aisle(" BLL          XXXBCBXXX          LLB ", "B                                   B", "L                                   L", "L                                   L", "                S X S                ", "                                     ", "                                     ", "         B X   X     X   X B         ", "           MLLLMB   BMLLLM           ", "       B B MLLLMXX XXMLLLM B B       ", "           MLLLMB   BMLLLM           ", "       XMMMB   X     X   BMMMX       ", "        LLL               LLL        ", "        LLL               LLL        ", "X       LLL               LLL       X", "X      XMMMX      X      XMMMX      X", "X       BXB               BXB       X", "B        X                 X        B", "C   X          X XBX X          X   C", "B        X                 X        B", "X       BXB               BXB       X", "X      XMMMX      X      XMMMX      X", "X       LLL               LLL       X", "        LLL               LLL        ", "        LLL               LLL        ", "       XMMMB   X     X   BMMMX       ", "           MLLLMB   BMLLLM           ", "       B B MLLLMXX XXMLLLM B B       ", "           MLLLMB   BMLLLM           ", "         B X   X     X   X B         ", "                                     ", "                                     ", "                S X S                ", "L                                   L", "L                                   L", "B                                   B", " BLL          XXXBCBXXX          LLB ")//27
                .aisle(" BLLLL           XMX           LLLLB ", "B                                   B", "L                                   L", "L                                   L", "L                                   L", "L                 X                 L", "                                     ", "          BX   X     X   XB          ", "        MX MLLLMXX XXMLLLM XM        ", "        XCBMCCCMMMBMMMCCCMBCX        ", "       B B MLLLMXX XXMLLLM B B       ", "       XMMMB   X     X   BMMMX       ", "        LCL               LCL        ", "        LCL               LCL        ", "        LCL               LCL        ", "     S XMMMX             XMMMX S     ", "     D  XMX       X       XMX  D     ", "X    D  XMX               XMX  D    X", "M    C   B      XXBXX      B   C    M", "X    D  XMX               XMX  D    X", "     D  XMX       X       XMX  D     ", "     S XMMMX             XMMMX S     ", "        LCL               LCL        ", "        LCL               LCL        ", "        LCL               LCL        ", "       XMMMB   X     X   BMMMX       ", "       B B MLLLMXX XXMLLLM B B       ", "        XCBMCCCMMMBMMMCCCMBCX        ", "        MX MLLLMXX XXMLLLM XM        ", "          BX   X     X   XB          ", "                                     ", "L                 X                 L", "L                                   L", "L                                   L", "L                                   L", "B                                   B", " BLLLL           XMX           LLLLB ")//28
                .aisle(" BLLLLL          XMX          LLLLLB ", "B                                   B", "L                                   L", "L                                   L", "L                                   L", "L                                   L", "L                 B                 L", "       MX  X   X     X   X  XM       ", "       XBM MLLLMB   BMLLLM MBX       ", "        MX MLLLMXX XXMLLLM XM        ", "           MLLLMB   BMLLLM           ", "       XMMMB   X     X   BMMMX       ", "        LLL               LLL        ", "        LLL               LLL        ", "        LLL               LLL        ", "       XMMMX             XMMMX       ", "        BXB       X       BXB        ", "X        X                 X        X", "M     B         XXBXX         B     M", "X        X                 X        X", "        BXB       X       BXB        ", "       XMMMX             XMMMX       ", "        LLL               LLL        ", "        LLL               LLL        ", "        LLL               LLL        ", "       XMMMB   X     X   BMMMX       ", "           MLLLMB   BMLLLM           ", "        MX MLLLMXX XXMLLLM XM        ", "       XBM MLLLMB   BMLLLM MBX       ", "       MX  X   X     X   X  XM       ", "L                 B                 L", "L                                   L", "L                                   L", "L                                   L", "L                                   L", "B                                   B", " BLLLLL          XMX          LLLLLB ")//29
                .aisle("X   LLLL         XMX         LLLL   X", "                                     ", "                                     ", "                                     ", "L                                   L", "L                                   L", "L     MX          B          XM     L", "L     XBM                   MBX     L", "       MX  X   X     X   X  XM       ", "          BX   X     X   XB          ", "         B X   X     X   X B         ", "        XXX               XXX        ", "                                     ", "                                     ", "                                     ", "        XXX               XXX        ", "                                     ", "X                 X                 X", "M     B          XBX          B     M", "X                 X                 X", "                                     ", "        XXX               XXX        ", "                                     ", "                                     ", "                                     ", "        XXX               XXX        ", "         B X   X     X   X B         ", "          BX   X     X   XB          ", "       MX  X   X     X   X  XM       ", "L     XBM                   MBX     L", "L     MX          B          XM     L", "L                                   L", "L                                   L", "                                     ", "                                     ", "                                     ", "X   LLLL         XMX         LLLL   X")//30
                .aisle("X     LLL        BCB        LLL     X", "                                     ", "                                     ", "                                     ", "                                     ", "     MX                       XM     ", "L    XBM                     MBX    L", "L     MX          B          XM     L", "L                 B                 L", "                                     ", "                                     ", "                                     ", "                                     ", "                                     ", "                                     ", "                                     ", "                                     ", "B                 X                 B", "C      BB        XBX        BB      C", "B                 X                 B", "                                     ", "                                     ", "                                     ", "                                     ", "                                     ", "                                     ", "                                     ", "                                     ", "L                 B                 L", "L     MX          B          XM     L", "L    XBM                     MBX    L", "     MX                       XM     ", "                                     ", "                                     ", "                                     ", "                                     ", "X     LLL        BCB        LLL     X")//31
                .aisle("X      LLL       XMX       LLL      X", "                                     ", "                                     ", "                                     ", "    MX                         XM    ", "    XBM                       MBX    ", "     MX                       XM     ", "L                                   L", "L                                   L", "L                 X                 L", "                                     ", "                                     ", "                                     ", "                                     ", "                                     ", "         S                 S         ", "         D                 D         ", "X        D        X        D        X", "M        C       XBX       C        M", "X        D        X        D        X", "         D                 D         ", "         S                 S         ", "                                     ", "                                     ", "                                     ", "                                     ", "                                     ", "L                 X                 L", "L                                   L", "L                                   L", "     MX                       XM     ", "    XBM                       MBX    ", "    MX                         XM    ", "                                     ", "                                     ", "                                     ", "X      LLL       XMX       LLL      X")//32
                .aisle(" X     LLL       XMX       LLL     X ", "X                                   X", "                                     ", "   MX                           XM   ", "   XBM                         MBX   ", "    MX                         XM    ", "                                     ", "L                                   L", "L                                   L", "L                                   L", "                S X S                ", "                D X D                ", "                                     ", "                                     ", "                                     ", "                                     ", "                                     ", "X                                   X", "M         XX      X      XX         M", "X                                   X", "                                     ", "                                     ", "                                     ", "                                     ", "                                     ", "                D X D                ", "                S X S                ", "L                                   L", "L                                   L", "L                                   L", "                                     ", "    MX                         XM    ", "   XBM                         MBX   ", "   MX                           XM   ", "                                     ", "X                                   X", " X     LLL       XMX       LLL     X ")//33
                .aisle(" X      LLL      XMX      LLL      X ", "X                                   X", "  MX                             XM  ", "  XBM                           MBX  ", "   MX                           XM   ", "                                     ", "                                     ", "                                     ", "L                                   L", "L                                   L", "L                                   L", "                                     ", "                D X D                ", "               XBXCXBX               ", "                D X D                ", "                                     ", "                                     ", "X                                   X", "M           XXX   X   XXX           M", "X                                   X", "                                     ", "                                     ", "                D X D                ", "               XBXCXBX               ", "                D X D                ", "                                     ", "L                                   L", "L                                   L", "L                                   L", "                                     ", "                                     ", "                                     ", "   MX                           XM   ", "  XBM                           MBX  ", "  MX                             XM  ", "X                                   X", " X      LLL      XMX      LLL      X ")//34
                .aisle("X X     LLL      XCX      LLL     X X", "  B                               B  ", "XBCM                             MCBX", "  MX                             XM  ", "                                     ", "                                     ", "                                     ", "                                     ", "L                                   L", "L                                   L", "L                                   L", "                                     ", "                                     ", "                                     ", "                                     ", "                D X D                ", "                S X S                ", "X                 X                 X", "C              XXXXXXX              C", "X                 X                 X", "                S X S                ", "                D X D                ", "                                     ", "                                     ", "                                     ", "                                     ", "L                                   L", "L                                   L", "L                                   L", "                                     ", "                                     ", "                                     ", "                                     ", "  MX                             XM  ", "XBCM                             MCBX", "  B                               B  ", "X X     LLL      XCX      LLL     X X")//35
                .aisle("B  XX   BBB      BBB      BBB   XX  B", "                                     ", "  B                               B  ", "X                                   X", "X                                   X", "                                     ", "                                     ", "                                     ", "B                                   B", "B                                   B", "B                                   B", "                                     ", "                                     ", "                                     ", "                                     ", "                                     ", "                                     ", "B                                   B", "B                 X                 B", "B                                   B", "                                     ", "                                     ", "                                     ", "                                     ", "                                     ", "                                     ", "B                                   B", "B                                   B", "B                                   B", "                                     ", "                                     ", "                                     ", "X                                   X", "X                                   X", "  B                               B  ", "                                     ", "B  XX   BBB      BBB      BBB   XX  B")//36
                .aisle(" BX  XXX   XXXMMM   MMMXXX   XXX  XB ", "B  XX   BBB      BBB      BBB   XX  B", "X X     LLL      XCX      LLL     X X", " X      LLL      XMX      LLL      X ", " X     LLL       XMX       LLL     X ", "X      LLL       XMX       LLL      X", "X     LLL        BCB        LLL     X", "X   LLLL         XMX         LLLL   X", " BLLLLL          XMX          LLLLLB ", " BLLLL           XMX           LLLLB ", " BLL          XXXBCBXXX          LLB ", "X           CC   XMX   CC           X", "X          C     XMX     C          X", "X          C     XMX     C          X", "M         X      BCB      X         M", "M         X     XMMMX     X         M", "M         X    XXBXBXX    X         M", " BXXXXBXXXBXXXBMBSXSBMBXXXBXXXBXXXXB ", " BCMMMCMMMCMMMCMXXBXXMCMMMCMMMCMMMCB ", " BXXXXBXXXBXXXBMBSXSBMBXXXBXXXBXXXXB ", "M         X    XXBXBXX    X         M", "M         X     XMMMX     X         M", "M         X      BCB      X         M", "X          C     XMX     C          X", "X          C     XMX     C          X", "X           CC   XMX   CC           X", " BLL          XXXBCBXXX          LLB ", " BLLLL           XMX           LLLLB ", " BLLLLL          XMX          LLLLLB ", "X   LLLL         XMX         LLLL   X", "X     LLL        BCB        LLL     X", "X      LLL       XMX       LLL      X", " X     LLL       XMX       LLL     X ", " X      LLL      XMX      LLL      X ", "X X     LLL      XCX      LLL     X X", "B  XX   BBB      BBB      BBB   XX  B", " BX  XXX   XXXMMM   MMMXXX   XXX  XB ")//37
                .where('B', states(GTNEMetaBlock.DHSCT_CASING.getState(DHSCTCasing.DHSCTCasingType.DIMENTIONAL_BRIDGE)))
                .where('X', states(GTNEMetaBlock.DHSCT_CASING.getState(DHSCTCasing.DHSCTCasingType.DIMENTIONALLY_TRANSCENDENT_CASING)))
                .where('M', states(GTNEMetaBlock.DHSCT_CASING.getState(DHSCTCasing.DHSCTCasingType.DIMENTIONAL_MATTER_INJECTION_CASING)))
                .where('S', states(GTNEMetaBlock.DHSCT_CASING.getState(DHSCTCasing.DHSCTCasingType.DIMENTIONAL_STABILISATION_FIELD_GENERATOR)))
                .where('C', states(GTNEMetaBlock.DHSCT_CASING.getState(DHSCTCasing.DHSCTCasingType.SPACETIME_CONTAINMENT_FIELD_GENERATOR)))
                .where('D', states(GTNEMetaBlock.DHSCT_CASING.getState(DHSCTCasing.DHSCTCasingType.SPACETIME_DILATION_FIELD_GENERATOR)))
                .where('A', selfPredicate())
                .where('L', states(GTNEMetaBlock.BLOCK_GTNE_WIRE_COIL.getState(BlockGTNEWireCoil.CoilType.STELLARIUM)))
                .where('F', states(GTNEMetaBlock.DHSCT_CASING.getState(DHSCTCasing.DHSCTCasingType.DIMENTIONAL_BRIDGE))
                        .or(FluidInputPredicate()))
                .where('U', MultiFluidPredicate())
                .where('E', states(GTNEMetaBlock.DHSCT_CASING.getState(DHSCTCasing.DHSCTCasingType.DIMENTIONAL_MATTER_INJECTION_CASING))
                        .or(abilities(MultiblockAbility.INPUT_ENERGY)))
                .where('I', states(GTNEMetaBlock.DHSCT_CASING.getState(DHSCTCasing.DHSCTCasingType.DIMENTIONAL_MATTER_INJECTION_CASING))
                        .or(ItemInputPredicate()))
                .where('O', states(GTNEMetaBlock.DHSCT_CASING.getState(DHSCTCasing.DHSCTCasingType.DIMENTIONAL_MATTER_INJECTION_CASING))
                        .or(OutputItemPredicate()))
                .where('Y', abilities(MultiblockAbility.COMPUTATION_DATA_RECEPTION).setExactLimit(2))
                .where(' ', any())
                .build();
    }

    protected static TraceabilityPredicate ItemInputPredicate() {
        return metaTileEntities(Arrays.stream(MetaTileEntities.ITEM_IMPORT_BUS)
                .filter(mte -> mte.getTier() >= UV)
                .toArray(MetaTileEntity[]::new))
                .setMinGlobalLimited(1)
                .setPreviewCount(1);
    }

    protected static TraceabilityPredicate OutputItemPredicate() {
        return metaTileEntities(Arrays.stream(MetaTileEntities.ITEM_EXPORT_BUS)
                .filter(mte -> mte.getTier() >= UV)
                .toArray(MetaTileEntity[]::new))
                .setExactLimit(1);
    }

    protected static TraceabilityPredicate FluidInputPredicate() {
        return metaTileEntities(MultiblockAbility.REGISTRY.get(MultiblockAbility.IMPORT_FLUIDS).stream()
                .filter(mte -> !(mte instanceof MetaTileEntityMultiFluidHatch))
                .toArray(MetaTileEntity[]::new));
    }

    protected static TraceabilityPredicate MultiFluidPredicate() {
        return metaTileEntities(MultiblockAbility.REGISTRY.get(MultiblockAbility.IMPORT_FLUIDS).stream()
                .filter(mte -> mte instanceof MetaTileEntityMultiFluidHatch)
                .toArray(MetaTileEntity[]::new));
    }

    @Override
    public ICubeRenderer getBaseTexture(IMultiblockPart sourcePart) {
        return GTNETextures.DIMENTIONALLY_TRANSCENDENT_CASING;
    }

    @Override
    public boolean hasMaintenanceMechanics() {
        return false;
    }

    private static class HDSCTRecipeLogic extends ComputationRecipeLogic {

        public HDSCTRecipeLogic(MetaTileEntityHighDimensionalStructureConstructionTesseract metaTileEntity) {
            super(metaTileEntity, ComputationType.SPORADIC);
        }

        @NotNull
        @Override
        public MetaTileEntityHighDimensionalStructureConstructionTesseract getMetaTileEntity() {
            return (MetaTileEntityHighDimensionalStructureConstructionTesseract) super.getMetaTileEntity();
        }

    }

}
